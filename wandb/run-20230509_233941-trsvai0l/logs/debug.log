2023-05-09 23:39:41,401 INFO    MainThread:14272 [wandb_setup.py:_flush():76] Current SDK version is 0.15.2
2023-05-09 23:39:41,401 INFO    MainThread:14272 [wandb_setup.py:_flush():76] Configure stats pid to 14272
2023-05-09 23:39:41,401 INFO    MainThread:14272 [wandb_setup.py:_flush():76] Loading settings from /home2/debashish.roy/.config/wandb/settings
2023-05-09 23:39:41,402 INFO    MainThread:14272 [wandb_setup.py:_flush():76] Loading settings from /home2/debashish.roy/CondensedMovies/wandb/settings
2023-05-09 23:39:41,402 INFO    MainThread:14272 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-05-09 23:39:41,402 INFO    MainThread:14272 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-05-09 23:39:41,402 INFO    MainThread:14272 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program': 'train.py'}
2023-05-09 23:39:41,402 INFO    MainThread:14272 [wandb_init.py:_log_setup():507] Logging user logs to /home2/debashish.roy/CondensedMovies/wandb/run-20230509_233941-trsvai0l/logs/debug.log
2023-05-09 23:39:41,402 INFO    MainThread:14272 [wandb_init.py:_log_setup():508] Logging internal logs to /home2/debashish.roy/CondensedMovies/wandb/run-20230509_233941-trsvai0l/logs/debug-internal.log
2023-05-09 23:39:41,403 INFO    MainThread:14272 [wandb_init.py:init():547] calling init triggers
2023-05-09 23:39:41,403 INFO    MainThread:14272 [wandb_init.py:init():555] wandb.init called with sweep_config: {}
config: {'cfg_fname': PosixPath('configs/moe.json'), 'resume': None, '_config': OrderedDict([('name', 'MoEE'), ('n_gpu', 1), ('arch', OrderedDict([('type', 'MoEE'), ('args', OrderedDict([('pretrained', ''), ('projection_dim', 512), ('use_moe', False), ('aggregation_method', OrderedDict([('label', OrderedDict([('type', 'net_vlad'), ('cluster_size', 10), ('ghost_clusters', 0)])), ('description', OrderedDict([('type', 'net_vlad'), ('cluster_size', 10), ('ghost_clusters', 0)])), ('face', OrderedDict([('type', 'mean')])), ('scene', OrderedDict([('type', 'mean')])), ('speech', OrderedDict([('type', 'mean'), ('cluster_size', 0), ('ghost_clusters', 0)]))]))]))])), ('data_loader', OrderedDict([('type', 'MovieClipsDataLoader'), ('args', OrderedDict([('data_dir', 'data'), ('metadata_dir', 'data/metadata'), ('batch_size', 64), ('shuffle', True), ('num_workers', 9), ('label', 'description'), ('experts_used', OrderedDict([('characters', False), ('clip_name', True), ('description', True), ('face', True), ('rgb', True), ('scene', True), ('speech', True), ('video', True), ('s3d', True)])), ('experts', OrderedDict([('characters', ''), ('clip_name', 'BERT/bert-large-cased/clip_name/agg/agg.npy'), ('context', ''), ('description', 'BERT/bert-large-cased/description/agg/agg_word.npy'), ('face', 'SE-ResNet-50/256D_vgg_face2/agg/agg_feats_mean.npy'), ('plot', 'BERT/bert-large-cased/plot/agg/agg.npy'), ('rgb', 'SE-ResNet-154/pred_imagenet_25fps_256px_stride1_offset0/agg/agg_feats_mean.npy'), ('scene', 'DenseNet-161/pred_scene_25fps_256px_stride1_offset0/agg/agg_feats_mean.npy'), ('speech', 'BERT/bert-large-cased/speech/agg/agg.npy'), ('video', 'I3D/pred_i3d_25fps_256px_stride25_offset0_inner_stride1/agg/agg_feats_mean.npy'), ('s3d', 'S3DG/pred_s3dg_10fps_256px_stride16_offset0_inner_stride1/agg/agg_feats_mean.npy')])), ('max_tokens', OrderedDict([('description', 20), ('characters', 10), ('face', 5), ('plot', 60), ('speech', 20)]))]))])), ('optimizer', OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 3e-05), ('weight_decay', 0), ('amsgrad', True)]))])), ('loss', OrderedDict([('type', 'MaxMarginRankingLoss'), ('args', OrderedDict([('margin', 0.12132983763957966), ('fix_norm', True)]))])), ('metrics', ['t2v_metrics', 'v2t_metrics']), ('lr_scheduler', OrderedDict([('type', 'StepLR'), ('args', OrderedDict([('step_size', 50), ('gamma', 0.1)]))])), ('trainer', OrderedDict([('epochs', 100), ('save_dir', 'saved'), ('save_period', 1), ('verbosity', 2), ('monitor', 'min val_t2v_metrics_MedR'), ('early_stop', 10), ('tensorboard', False), ('retrieval', 'inter')]))]), '_save_dir': PosixPath('saved/models/MoEE/0509_233937'), '_log_dir': PosixPath('saved/log/MoEE/0509_233937'), 'log_levels': {0: 30, 1: 20, 2: 10}}
2023-05-09 23:39:41,403 INFO    MainThread:14272 [wandb_init.py:init():596] starting backend
2023-05-09 23:39:41,403 INFO    MainThread:14272 [wandb_init.py:init():600] setting up manager
2023-05-09 23:39:41,409 INFO    MainThread:14272 [backend.py:_multiprocessing_setup():108] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-05-09 23:39:41,413 INFO    MainThread:14272 [wandb_init.py:init():606] backend started and connected
2023-05-09 23:39:41,417 INFO    MainThread:14272 [wandb_init.py:init():700] updated telemetry
2023-05-09 23:39:42,354 INFO    MainThread:14272 [wandb_init.py:init():737] communicating run to backend with 60.0 second timeout
2023-05-09 23:39:43,271 WARNING MainThread:14272 [wandb_init.py:init():1172] interrupted
Traceback (most recent call last):
  File "/home2/debashish.roy/miniconda3/envs/IS/lib/python3.7/site-packages/wandb/sdk/wandb_init.py", line 1150, in init
    run = wi.init()
  File "/home2/debashish.roy/miniconda3/envs/IS/lib/python3.7/site-packages/wandb/sdk/wandb_init.py", line 784, in init
    run._set_run_obj(run_result.run)
  File "/home2/debashish.roy/miniconda3/envs/IS/lib/python3.7/site-packages/wandb/sdk/wandb_run.py", line 1480, in _set_run_obj
    self._settings._apply_run_start(message_to_dict(self._run_obj))
  File "/home2/debashish.roy/miniconda3/envs/IS/lib/python3.7/site-packages/wandb/sdk/lib/proto_util.py", line 106, in message_to_dict
    from google.protobuf.json_format import MessageToDict
  File "/home2/debashish.roy/miniconda3/envs/IS/lib/python3.7/site-packages/google/protobuf/json_format.py", line 54, in <module>
    from google.protobuf.internal import type_checkers
  File "/home2/debashish.roy/miniconda3/envs/IS/lib/python3.7/site-packages/google/protobuf/internal/type_checkers.py", line 328, in <module>
    _FieldDescriptor.TYPE_FIXED64: wire_format.Fixed64ByteSize,
KeyboardInterrupt
2023-05-09 23:39:47,781 WARNING MsgRouterThr:14272 [router.py:message_loop():77] message_loop has been closed
